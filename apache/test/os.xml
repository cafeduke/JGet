<project name="test-os">
  <description>
    This project is to define or override properties, which are required to run
    tests on different OS. It should be called at the top level of the xml file
  </description>
    
  <!-- do not use task (e.g. if) from antcontrib lib since it might be called before 
    any antcontrib-root from testtool is imported -->

  <dirname property="test-os.dir" file="${ant.file.test-os}" />

  <!-- determine the OS -->
  <condition property="isWindows">
    <os family="windows" />
  </condition>
  <condition property="isUnix">
    <os family="unix" />
  </condition>
  
  <!-- Unix specific properties -->
  <condition property="executable" value="sh">
    <isset property="isUnix" />
  </condition>

  <condition property="qaenv.exec.argline" value="-c ./qaenv.sh">
    <isset property="isUnix" />
  </condition>

  <!-- Windows specific properties -->
  <condition property="executable" value="cmd">
    <isset property="isWindows" />
  </condition>

  <condition property="qaenv.exec.argline" value="/c qaenv.cmd">
    <isset property="isWindows" />
  </condition>

  <condition property="global.fastfail" value="false">
    <isset property="isWindows" />
  </condition>    

  <condition property="global.memargs" value="-Xms256m -Xmx1024m -XX:PermSize=256m -XX:MaxPermSize=512m -XX:MaxNewSize=65m -XX:NewSize=65m">
    <and>
      <isset property="isWindows" />
      <not>
          <or>
            <contains string="${java.vm.vendor}" substring="BEA" casesensitive="false" />
            <contains string="${java.vm.vendor}" substring="JRockit" casesensitive="false" />
            <contains string="${java.vm.vendor}" substring="Oracle" casesensitive="false" />
          </or>
      </not>
    </and>
  </condition>  
</project>

