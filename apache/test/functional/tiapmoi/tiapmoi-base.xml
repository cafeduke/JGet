<?xml version="1.0"?>
<project name="tiapmoi.base">
  <description>
    Team base file

    It defines properties and libraries that are used by all team Ant file.
    User can also add utlity targets.
  </description>

  <!-- ==================================================================== -->
  <!-- START: Properties                                                    -->
  <!-- ==================================================================== -->

  <!-- ADDED-BY-SEED Absolute path to this file -->
  <dirname property="tiapmoi.base.dir" file="${ant.file.tiapmoi.base}" />

  <!-- ADDED-BY-SEED Standard property to identify team base directory -->
  <property name="team.base.dir" value="${tiapmoi.base.dir}"/>

  <!-- ADDED-BY-SEED Team to which tests belong -->
  <property name="team" value="tiapmoi"/>

    
  <!-- ==================================================================== -->
  <!-- START: Imports                                                       -->
  <!-- ==================================================================== -->

  <!-- ADDED-BY-SEED Import functional area base file -->
  <import file="${tiapmoi.base.dir}/../functional-base.xml" />


  <!-- ADDED-BY-SEED Marker file which is created when team setup target has
                     successfully run
   -->
  <property name="team.setup.marker.file"
       value="${run.output.dir}/tiapmoi-setup-marker.properties" />


  <!-- =================================================== -->
  <!-- scanDir -->
  <!-- =================================================== -->
  <target name="scanDir" >
  <description>
     Scan a given directory and sort the contents.  Write
     results into outfile.
     Params:
       ${action}    - location to scan - permitted values:
                      [ohs_bin, ohs_conf, ohs_lib]
                      [oi_conf, oi_inst, oi_logs, oi_syst]
       ${ohsName}   - OHS name - needed for ORACLE_INSTANCE locations
       ${outfile}   - the sorted results of the scan
  </description>

   <tl-exec name="scanDir" executable="perl"
       cmdfile="${twork.dir}/tmp.txt"
       output="${twork.dir}/${outfile}"
       failonerror="true">
       <arg line="${team.base.dir}/common/perl/scan_dir.pl" />
       <arg line="${action}" />
       <arg line="${twork.dir}/${outfile}" />
       <arg line="${ohsName}" />
       <env key="PLATFORM"        value="${platform}" />
       <env key="T_WORK"          value="${twork.dir}" />
       <env key="ORACLE_HOME"     value="${ORACLE_HOME}" />
       <env key="ohsConfDir"      value="${ohsConfDir}" />
       <env key="nmLogDir"        value="${nmLogDir}" />
       <env key="ohsLogDir"       value="${ohsLogDir}" />
   </tl-exec>
   </target>

  <!-- =================================================== -->
  <!-- compareFiles -->
  <!-- =================================================== -->
  <target name="compareFiles" >
  <description>
     Compare a given goldfile with testlog.  Differences (if any)
     are written to outfile.  Throw an error if there are differences.
     All files are expected to exist in T_WORK.
     Params:
       ${goldfile}  - file name of expected results
       ${testfile}  - actual results (expected in T_WORK)
       ${outfile}   - any differences between the two
  </description>
     <tl-exec name="compFiles" executable="perl"
       cmdfile="${twork.dir}/tmp.txt"
       output="${twork.dir}/${outfile}"
       failonerror="true">
       <arg line="${team.base.dir}/common/perl/compare_files.pl" />
       <arg line="${twork.dir}/${goldfile}" />
       <arg line="${twork.dir}/${testfile}" />
       <arg line="${twork.dir}/${outfile}" />
     </tl-exec>
   </target>

</project>
