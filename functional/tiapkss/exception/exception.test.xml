<?xml version="1.0" encoding="utf-8"?>
<project name="tiapkss.exception" default="usage">
  <description>
    functional tiapkss exception tests.

    @testlogic.group  type="working" values="true"  
    @testlogic.group type="install" values="full"
    @testlogic.group type="winFIPS" values="false"
  </description>

  <!-- ADDED-BY-SEED Absolute path to this file -->
  <dirname property="tiapkss.exception.dir" file="${ant.file.tiapkss.exception}" />

  <!-- ADDED-BY-SEED Import base file -->
  <import file="${tiapkss.exception.dir}/../tiapkss-test-base.xml" />

  <!-- =================================================== -->
  <!-- prepare -->
  <!-- =================================================== -->

  <target name="prepare" >
  <description>
     Remove any old logfiles lingering in T_WORK.
     Create and start a kss instance.
  </description>
    <firsttimeonly>
     <delete>
        <fileset dir="${twork.dir}" includes="tiapkss_exception*"/>
     </delete>

    <!-- Create a new OHS instance -->
    <antcall target="createOHS">
      <param name="out.log"  value="tiapkss_exception_crt.log"/>
      <param name="ohs.name" value="kss"/>
    </antcall>

    <!-- Start kss_except -->
    <antcall target="startOHS">
      <param name="out.log"  value="tiapkss_exception_start.log"/>
      <param name="ohs.name" value="kss"/>
    </antcall>

    </firsttimeonly>
  </target>

  <!-- =================================================== -->
  <!-- unprepare -->
  <!-- =================================================== -->

  <target name="unprepare" >
  <description>
     Shutdown kss instance
  </description>
    <firsttimeonly>
    <trycatch>
    <try>
      <antcall target="stopOHS">
        <param name="out.log"  value="tiapkss_exception_stop.log"/>
        <param name="ohs.name" value="kss"/>
      </antcall>
    </try>
    </trycatch>
    </firsttimeonly>
  </target>

  <!-- =================================================== -->
  <!-- suite -->
  <!-- =================================================== -->

  <target name="suite">
    <description>
       Tests to check out KSS exceptions
    </description>
      
      <!-- Check out basic exception cases -->
      <antcall target="basic"/>

  </target>


   <!-- ====================================================== -->
   <target name="basic">
   <description>
     Check out basic KSS exception cases
   </description>

       <property name="tstName" value="tiapkss_exception_basic"/>
       <property name="ohsName" value="kss"/>
       <property name="scriptDir" value="${tiapkss.base.dir}/common/wlst"/>
       <property name="script"  value="exception_basic.py"/>
       <copy file="${gold.path}/exception_basic.gold"
         tofile="${twork.dir}/${tstName}.gold"/>

       <!-- Run the WLST script -->
       <antcall target="wlstRunScript">
          <param name="script" value="${scriptDir}/${script}"/>
          <param name="ohsName" value="${ohsName}"/>
          <param name="outfile" value="${tstName}.out"/>
       </antcall>

       <!-- compare script output to the goldfile -->
       <antcall target="wlstCompareLogs">
           <param name="logfile"  value="${tstName}.out"/>
           <param name="goldfile" value="${tstName}.gold"/>
           <param name="outfile"  value="${tstName}.log"/>
       </antcall>
   </target>

  
</project>

 
